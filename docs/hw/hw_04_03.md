# hw 04 - 03

## Ex. 1

对于文法 `S → S S + | S * | a` 和下面的最右句型, 指出其归约时使用到的句柄.

1. `S S + a * +`
2. `S S * a +`
3. `a a * a + + a +`

> See also Ex. 4.5.2.

### Solution

> 第 2 小问的题目有误: 该串无法推导.

> 注意! 以后写的时候要 **写清楚句柄在串中的具体位置**.

1. `S S +`
2. `S *`
3. (第 1 个) `a`

## Ex. 2

对于文法 `S → S S + | S * | a` ,

1. 增广该文法, 构造 SLR 项目集;
2. 计算这些项目集的 GOTO 函数, 给出这个文法的语法分析表;
3. 这个文法是 SLR 文法吗?

> See also Ex. 4.6.2

### Solution

**增广该文法**: 添加到起始状态的 `S' -> S`

```
(行号=编号)
S' -> S
S  -> S S +
S  -> S *
S  -> a
```

基于 LR(0) 项集族 `C={I0, I1, ...}` **构造 SLR 项目集**:

> 原来做的时候, FOLLOW 集合判断错误; 后来发现其实是项目集族都有错误 (多写了一项).

文法中的 FIRST 集合:

```
FIRST(S) = {a}
FIRST(S S +) = {a}
FIRST(S *) = {a}
FIRST(a) = {a}
```

文法中的 FOLLOW 集合:

```
FOLLOW(S) = {$, +, *, a}
```

> 注:
>
> - 单个方框为集合,
> - `----` 以上是集合名,
> - `~~` 上下分别为求闭包得到/内核项得到.

![ex02-lr-0](hw_04_03.assets/comp0403-ex2-lr-0.png){ : style="height:400px"}

**语法分析表**:

步骤:

1. 对所有的 `A -> α . a β` 找移进操作;
2. 对所有的 `A -> α .` 找归约操作;
3. 把 `S' -> S` 对应的 `$` 项目设为 acc;
4. 保留其他空白, 意为 error.

![ex2-slr-table](hw_04_03.assets/comp0403-ex2-slr-table.png){ : style="height:150px"}

**GOTO 函数**:

```
GOTO(I0, S) = I1, GOTO(I0, a) = I2,
GOTO(I1, S) = I2, GOTO(I1, *) = I5, GOTO(I1, a) = I2, GOTO(I1, $) = acc
GOTO(I3, a) = I2, GOTO(I3, S) = I3, GOTO(I3, +) = I4, GOTO(I3, *) = I5
```

**判断**: 该文法是 SLR 文法, 因为没有出现冲突的条目.

## Ex. 3

对于文法 `S → S S + | S * | a` ,

1. 构造规范 LR 项目集族;
2. 构建其语法分析表;
3. 构建 LALR 项目集族.

> See also Ex. 4.7.1, 4.7.3

### Solution

增广文法:

```
S' -> S
S  -> S S +
S  -> S *
S  -> a
```

文法中的 FIRST 集合:

```
FIRST(S) = {a}
FIRST(S S +) = {a}
FIRST(S *) = {a}
FIRST(a) = {a}
```

文法中的 FOLLOW 集合:

```
FOLLOW(S) = {$, +, *, a}
```

**构造规范 LR 项目集族**:

![ex02-lr-1](hw_04_03.assets/comp0403-ex2-lr-1.png){ : style="height:400px"}

GOTO 函数:

```
GOTO(I0, S)=I1, GOTO(I0, a)=I4,
GOTO(I1, S)=I2, GOTO(I1, *)=I6, GOTO(I1, a)=I5, GOTO(I1, $)=acc,
GOTO(I2, S)=I3, GOTO(I2, *)=I7, GOTO(I2, +)=I8, GOTO(I2, a)=I5,
GOTO(I3, S)=I3, GOTO(I3, a)=I5, GOTO(I3, *)=I7, GOTO(I3, +)=I9
```

**构建语法分析表**:

![comp0403-ex2-lr1-table](hw_04_03.assets/comp0403-ex2-lr1-table.png){ : style="height:180px"}

**构建 LALR 项目集族**:

![comp0403-ex2-lalr](hw_04_03.assets/comp0403-ex2-lalr.png){ : style="height:350px"}
